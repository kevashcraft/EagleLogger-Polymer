<dom-module id="elp-login">
<style>
	:host {
		display: block;
	}
	paper-button {
		margin-top: 20px;
	}
	paper-dialog paper-icon-button[icon="close"] {
		position: absolute;
		top: -5px;
		right: 0;
	}
</style>
<template>
	<el-dialog heading="Login/Register" open-me enter-pressed="login" hide-close no-esc no-outside>
		<paper-input label="Callsign" value="{{callsign}}" autofocus></paper-input>
		<paper-input label="Password" value="{{password}}" type="password"></paper-input>
		<div style="text-align: center">
			<paper-button on-tap="login" raised>Login</paper-button>
			<paper-icon-button icon="help" on-tap="helpMe" style="position: absolute; left: 0; bottom: 5px"></paper-icon-button>
		</div>
	</el-dialog>

	<el-dialog id="help" heading="How to register">
		<p style="font-size: 21px">
			Never logged in before?<br>
			Enter your callsign and desired password<br>
			a new account will be created for you :)
		</p>
	</el-dialog>
</template>
</dom-module>
<script>
	Polymer({
		is: 'elp-login',
		behaviors: [
			Polymer.ELBehavior,
		],
		properties: {
			info: {
				type: Object,
				value: {
					title: 'Login',
					url: '/login'
				}
			},
			callsign: {
				type: String,
				observer: '_callsignChanged'
			}
		},
		ready: function() {
		},
		helpMe: function() {
			this.$.help.open();
		},
		login: function() {
			this.jaxson('users/login',{
				callsign: this.callsign,
				password: this.password
			});
		},
		_callsignChanged: function(callsign) {
			this.callsign = callsign.toUpperCase();
		},
		_jaxson: function(response) {
			if(response.user)
				EL.login(response.user);
		},
	});
</script>