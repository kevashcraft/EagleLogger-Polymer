<dom-module id="elp-dashboard">
<style>
	:host {
		display: block;
	}
	paper-material {
		padding: 15px;
		margin: 5px;
		background-color: var(--page-color-one);
	}
	h1 {
		text-align: center;
	}
	p {
		padding: 25px 35px 15px 35px;
	}
	paper-button {
		background-color: var(--page-background-toolbar);
		color: white;
	}
</style>
<template>
	<paper-material elevation="1">
		<h1><span>{{callsign}}</span>'s Dashboard</h1>
		<hr>
		<p>
			<b>Thank you</b> for registering!
		<p>
			<b>Here</b> you can update your <paper-button raised on-tap="dialog" data-dialog="information">information</paper-button>
		</p>
		<p>
			<b>You</b> can also change your <paper-button raised on-tap="dialog" data-dialog="password">password</paper-button>
		</p>
	</paper-material>

	<el-dialog heading="Change Your Password" id="password" no-outside enter-pressed="passwordChange">
		<paper-input value="{{password}}" type="password" label="New Password" autofocus></paper-input>
		<div style="text-align: center">
			<paper-button on-tap="passwordChange" raised>Update</paper-button>
		</div>
	</el-dialog>

	<el-dialog heading="Update Your Information" id="information" no-outside enter-pressed="informationUpdate">
		<paper-input value="{{name}}" label="Name" autofocus></paper-input>
		<paper-input value="{{county}}" label="County"></paper-input>
		<paper-input value="{{city}}" label="City"></paper-input>
		<paper-input value="{{website}}" label="Website"></paper-input>
		<paper-input value="{{blurb}}" label="Blurb"></paper-input>
		<div style="text-align: center">
			<paper-button on-tap="informationUpdate" raised>Update</paper-button>
		</div>
	</el-dialog>
</template>
</dom-module>
<script>
	Polymer({
		is: 'elp-dashboard',
		properties: {
			authedRequired: {
				type: Boolean,
				value: true
			},
			info: {
				type: Object,
				value: {
					title: 'Dashboard',
					url: '/dashboard'
				}
			},
			callsign: {
				type: String
			},
			password: {
				type: String
			}
		},
		behaviors: [
			Polymer.ELBehavior
		],
		ready: function() {
			this.callsign = EL.user.callsign;
		},
		passwordChange: function() {
			this.jaxson('users/change_password', {
				uid: EL.user.uid,
				password: this.password
			});
			this.dialog.close();
		},
		informationUpdate: function() {
			this.dialogClose();
			EL.user.county = this.county;
			EL.user.city = this.city;
			EL.user.name = this.name;
			EL.user.website = this.website;
			EL.user.blurb = this.blurb;
			EL.user = JSON.parse(JSON.stringify(EL.user));

			this.jaxson('users/update_information', {
				cid: EL.user.cid,
				county: this.county,
				city: this.city,
				website: this.website,
				blurb: this.blurb,
				name: this.name
			});
		},
		_dialog: function(dialog, target) {
			switch(dialog) {
				case 'information':
					this.name = EL.user.name || '';
					this.county = EL.user.county || '';
					this.city = EL.user.city || '';
					this.website = EL.user.website || '';
					this.blurb = EL.user.blurb || '';
					break;
			}
			return dialog;
		},
		_jaxson: function(info) {
			console.log("info",info);
		},
	});
</script>