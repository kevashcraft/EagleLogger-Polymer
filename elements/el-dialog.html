<dom-module id="el-dialog">
	<style>
		paper-dialog {
			padding: 25px;
			padding-top: 0;
		}

		paper-icon-button {
			position: absolute;
			top: 0;
			margin: 0;
		}
		paper-icon-button[icon="editor:mode-edit"] {
			left: 0;
		}
		paper-icon-button[icon="close"] {
			right: 0;
		}

		h2 {
			padding: 25px;
			text-align: center;
		}
	</style>
<template>
	<paper-dialog
		id="dialog"
		animation-config="[[animationConfig]]"
 		no-cancel-on-outside-click="[[noClick]]"
 		no-cancel-on-esc-key="[[noEsc]]"
 		no-auto-focus
 		>
		<paper-icon-button icon="editor:mode-edit" on-tap="_edit" hidden="[[noEdit]]"></paper-icon-button>
		<paper-icon-button icon="close" on-tap="close" hidden="[[noClose]]"></paper-icon-button>
		<h2>[[heading]]</h2>
		<content></content>
	</paper-dialog>
</template>
</dom-module>
<script>
	Polymer({
		is: 'el-dialog',
		listeners: {
			'keydown': '_keyPress',
			'iron-overlay-opened': '_opened',
		},
		properties: {
			heading: {
				type: String
			},
			editable: {
				type: Boolean,
				value: false
			},
			noClose: {
				type: Boolean,
				value: false
			},
			noEdit: {
				type: Boolean,
				value: true
			},
			noEsc: {
				type: Boolean,
				value: false
			},
			noClick: {
				type: Boolean,
				value: false
			},
			opened: {
				type: Boolean,
				value: false,
				reflectToAttribute: true
			},
		},
		// grab the dialog when attached
		attached: function() {
			this.dialog = this.$.dialog;
		},
		close: function() {
			// change opened attribute
			this.opened = false;
			// close dialog
			this.dialog.close();
		},
		// passes fit to the dialog
		fit: function() {
			this.dialog.fit();
		},
		open: function() {
			// show edit button if editable
			if(this.editable) this.noEdit = false;
			// change opened attribute
			this.opened = true;
			// open dialog
			this.dialog.open();
		},
		// fires edit event
		_edit: function() {
			// hide button
			this.noEdit = true;
			// fire event
			this.fire('edit');
		},
		_opened: function(event) {
			// ignore if not for me
			if(event.target.tagName != this.dialog.tagName) return;
			// refit dialog
			this.dialog.fit();
			// autofocus input
			var input = this.dialog.querySelector('[autofocus]');
			if(input) {
				var tagName = input.tagName.toLowerCase();
				switch(tagName) {
					case 'paper-input':
							console.log("input",input);
							input.$.input.focus();
						break;
					default:
						input.focus();
				}
			}
		},
		_keyPress: function(e) {
			// fire enter event
			if(e.keyCode === 13)
		    	this.fire('enter');
     	},
	});
</script>